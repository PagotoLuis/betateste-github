From 742ebe74153ffbdea221e3f6dc159132d97adb7c Mon Sep 17 00:00:00 2001
From: Joseph Sutton <josephsutton@catalyst.net.nz>
Date: Wed, 20 Oct 2021 15:48:35 +1300
Subject: [PATCH 199/361] CVE-2020-25718 tests/krb5: Allow tests accounts to
 replicate to RODC

BUG: https://bugzilla.samba.org/show_bug.cgi?id=14558

Signed-off-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
---
 python/samba/tests/krb5/rodc_tests.py | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/python/samba/tests/krb5/rodc_tests.py b/python/samba/tests/krb5/rodc_tests.py
index 302ae865cf1..0e252d90262 100755
--- a/python/samba/tests/krb5/rodc_tests.py
+++ b/python/samba/tests/krb5/rodc_tests.py
@@ -41,11 +41,13 @@ class RodcKerberosTests(KDCBaseTest):
         user_creds = self.get_cached_creds(
             account_type=self.AccountType.USER,
             opts={
+                'allowed_replication': True,
                 'revealed_to_rodc': True
             })
         target_creds = self.get_cached_creds(
             account_type=self.AccountType.COMPUTER,
             opts={
+                'allowed_replication': True,
                 'revealed_to_rodc': True
             })
 
-- 
2.30.2

