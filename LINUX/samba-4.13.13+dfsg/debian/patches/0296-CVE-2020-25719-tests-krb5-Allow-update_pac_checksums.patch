From 21db490c2bbb626d7fb9324994e34e744b8ba48b Mon Sep 17 00:00:00 2001
From: Joseph Sutton <josephsutton@catalyst.net.nz>
Date: Tue, 26 Oct 2021 20:47:53 +1300
Subject: [PATCH 296/361] CVE-2020-25719 tests/krb5: Allow
 update_pac_checksums=True if the PAC is not present

BUG: https://bugzilla.samba.org/show_bug.cgi?id=14561

Signed-off-by: Joseph Sutton <josephsutton@catalyst.net.nz>
Reviewed-by: Andrew Bartlett <abartlet@samba.org>
---
 python/samba/tests/krb5/raw_testcase.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/python/samba/tests/krb5/raw_testcase.py b/python/samba/tests/krb5/raw_testcase.py
index 18ee8738eaa..39ca4a69e1c 100644
--- a/python/samba/tests/krb5/raw_testcase.py
+++ b/python/samba/tests/krb5/raw_testcase.py
@@ -3293,7 +3293,7 @@ class RawKerberosTest(TestCaseInTempDir):
             self.assertFalse(checksum_keys)
             self.assertFalse(include_checksums)
 
-        expect_pac = update_pac_checksums or modify_pac_fn is not None
+        expect_pac = modify_pac_fn is not None
 
         key = ticket.decryption_key
 
-- 
2.30.2

